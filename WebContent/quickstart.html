<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js "></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script><style>.pdftype{position:absolute;background-color:#95b3e2 ;}.pages{display: flex;justify-content: center;}" </style><script src="http://sudeesh.host22.com/vishnu%20g/jSignature.min.js"></script><script> jsonstring='[{"page":1,"val":[{"location":883,"id":"signature46168","state":"yes","x":314,"y":883,"uid":1,"width":285,"height":50,"stagename":"Director-of-Sales","stageno":1,"userid":"john@cygnussoftwares.com","disabled":"false","mandatory":"false"}]},{"page":2,"val":[{"location":763,"id":"text18450","state":"no","x":182,"y":763,"uid":2,"width":254,"height":50,"stagename":"General-Manager","stageno":2,"userid":"elon@cygnussoftwares.com","disabled":"false","mandatory":"false"}]},{"page":14,"val":[{"location":544,"id":"text99167","state":"no","x":115,"y":544,"uid":3,"width":148,"height":50,"stagename":"VP","stageno":3,"userid":"michael@cygnussoftwares.com","disabled":"false","mandatory":"false"},{"location":545,"id":"initial61342","state":"no","x":265,"y":545,"uid":4,"width":130,"height":50,"stagename":"VP","stageno":3,"userid":"michael@cygnussoftwares.com","disabled":"false","mandatory":"false"},{"location":619,"id":"text99288","state":"no","x":115,"y":619,"uid":5,"width":150,"height":50,"stagename":"Owner","stageno":4,"userid":"maha@cygnussoftwares.com","disabled":"false","mandatory":"false"},{"location":624,"id":"signature65943","state":"no","x":268,"y":624,"uid":6,"width":370,"height":50,"stagename":"Owner","stageno":4,"userid":"maha@cygnussoftwares.com","disabled":"false","mandatory":"false"}]}]'; no_of_pages=14;$(document).ready(function () {    $("#signature").jSignature({        color: "#00f",        lineWidth: 3,        width: 600,        height: 200,        border: 1    });});current_page = 1;var no_of_pages;position_array = JSON.parse(jsonstring);var current_id, x, y;var old_page_no = 1;var uid = 1;var last_elem_uid;var start_elem_uid = 0;var currStage = "";var currStageUsers = "";function myfunction() {    len1 = position_array.length - 1;    len2 = position_array[len1].val.length - 1;    last_elem_uid = position_array[len1].val[len2].uid;    formvalidation();    setfonts(1);    setsize();        currStage = document.getElementById("currStage").value;    currStageUsers = document.getElementById("currStageUsers").value;    setField4CurrUser(currStage, currStageUsers);    uid = start_elem_uid;    setcurrentid();    var rejectFlag = "false";    if (rejectFlag != "true") {        document.getElementById("rejectBtn").style.visibility = "hidden";    }}function setoldvalues(){    var jsonStr = "[{"page_no":1,"id":"signature46168","value":"E:\\Business Planner Original - Copy\\Business Planner\\ESignImageFolder\\vishnu@cygnussoftwares.com_CgOjF\\BP_59170_signature46168\\signature46168.png","x":314,"y":883,"width":285,"height":50},{"page_no":2,"id":"text18450","value":"null","x":182,"y":763,"width":254,"height":50},{"page_no":14,"id":"text99167","value":"null","x":115,"y":544,"width":148,"height":50},{"page_no":14,"id":"initial61342","value":"null","x":265,"y":545,"width":130,"height":50},{"page_no":14,"id":"text99288","value":"null","x":115,"y":619,"width":150,"height":50},{"page_no":14,"id":"signature65943","value":"null","x":268,"y":624,"width":370,"height":50}]";    if (jsonStr == "")        return;    var oldvalues = JSON.parse(jsonStr);    for (var i = 0; i < oldvalues.length; i++)    {        var id =oldvalues[i].id;        var value=oldvalues[i].value;        if(value!="null")        {            if (id.includes("text"))            {                document.getElementById(id).value = value;            }            else if (id.includes("label")) {                document.getElementById(id).innerHTML = value;            }            else if (id.includes("check")) {                document.getElementById(id).checked = value;            }            else if (id.includes("comments")) {                document.getElementById(id).innerHTML = value;            }            else {                if(value.includes('~'))                {                    var res = value.split("~");                    var element=document.getElementById(id);                    element.innerHTML = res[0];                    element.style.fontSize=res[2];                    element.style.fontFamily=res[1];                }                else{                }            }        }    }}function downloadOutputPdfFile() {    var docId = findGetParameter("docid");    var downloadURL = "http://localhost:8080/rbid/download?filename=BP_59170_Collate_09070.pdf&filepath=&docID=420&username=john@cygnussoftwares.com&downloadFrom=Mail&attachmentType=Primary" + "&flag=true";    var win = window.open(downloadURL, '_blank');}function findGetParameter(parameterName) {    var result = null,        tmp = [];    location.search        .substr(1)        .split("&")        .forEach(function (item) {            tmp = item.split("=");            if (tmp[0] === parameterName) result = decodeURIComponent(tmp[1]);        });    return result;}function setField4CurrUser(currStage, currStageUsers) {    var k = 0;    var url_string = window.location.href;    var url = new URL(url_string);    var userid = url.searchParams.get("id");    for (i = 0; i < position_array.length; i++) {        for (j = 0; j < position_array[i].val.length; j++) {            var stgNo = position_array[i].val[j].stageno;            var id = position_array[i].val[j].id;            if (currStage == stgNo && currStageUsers.includes(userid)) {                if (k == 0) {                    start_elem_uid = position_array[i].val[j].uid;                } else {                    last_elem_uid = position_array[i].val[j].uid;                }                k++;            } else {                if (id.includes("signature") || id.includes("initial")) {                    var ee = document.getElementById(id);                    ee.setAttribute("onclick", "");                } else {                    document.getElementById(id).disabled = "true";                }            }        }    }}function setpage() {    document.getElementById("current").innerHTML = current_page;    document.getElementById("total").innerHTML = no_of_pages;}function next() {    if (current_page != no_of_pages) {        document.getElementById("page" + current_page).style.display = "none";        current_page = current_page + 1;        document.getElementById("page" + current_page).style.display = "block";        checkElements();    }    else {        alert("Last page");    }}function previous() {    if (current_page != 1) {        document.getElementById("page" + current_page).style.display = "none";        current_page = current_page - 1;        document.getElementById("page" + current_page).style.display = "block";        checkElements();    } else {        alert("first page");    }}function setcurrentid() {    var flag = false;    for (i = 0; i < position_array.length; i++) {        for (j = 0; j < position_array[i].val.length; j++) {            if (parseInt(position_array[i].val[j].uid) == uid) {                current_id = position_array[i].val[j].id;                var stgNo = position_array[i].val[j].stageno;                var userid = position_array[i].val[j].userid;                if (currStage == stgNo && currStageUsers.includes(userid)) {                    x = position_array[i].val[j].x;                    y = position_array[i].val[j].y;                    current_page = parseInt(position_array[i].page);                    uid = position_array[i].val[j].uid;                    makenextprevious();                    flag = true;                    break;                }            }        }        if (flag) {            break;        }    }    return flag;}function makenextprevious() {    try {        var rem = document.getElementById("rem");        rem.parentNode.removeChild(rem);    } catch (e) { }    var page3 = document.getElementsByClassName('pages');    for (t = 0; t < page3.length; t++) {        page3[t].style.display = 'none';    }    var page4 = document.getElementsByClassName('pdftype');    for (t1 = 0; t1 < page4.length; t1++) {        page4[t1].style.border = "none";    }    ele = document.getElementById(current_id);    ele.style.border = "1px solid red";    document.getElementById("page" + current_page).style.display = "block";    var main = document.getElementById("page" + current_page);    div = document.createElement("div");    div.style.zIndex = "500";    div.setAttribute("id", "rem");    div.style.marginTop = (parseInt(y) - 35) + "px";    div.style.marginLeft = x + "px";    var pb = document.createElement("button");    pb.setAttribute("id", "prev1");    icon2 = document.createElement("i");    icon2.setAttribute("class", "fa fa-backward");    pb.appendChild(icon2);    pb.style.zIndex = "100";    pb.setAttribute("onclick", "previouselement();");    var nb = document.createElement("button");    nb.setAttribute("id", "next1");    icon1 = document.createElement("i");    icon1.setAttribute("class", "fa fa-forward");    nb.appendChild(icon1);    nb.style.zIndex = "100";    nb.setAttribute("onclick", "nextelement();");    div.appendChild(pb);    div.appendChild(nb);    main.appendChild(div);    if (uid == 1 || uid == start_elem_uid) {           }    if (uid == last_elem_uid) {    }}function nextelement() {    if (uid != last_elem_uid) {        while (true) {            uid = uid + 1;            if (uid > last_elem_uid)                break;            var flag = setcurrentid();            if (flag)                break;        }    }    return false;}function previouselement() {    if (uid != 1) {        while (true) {            uid = uid - 1;            if (uid <= 0)                break;            var flag = setcurrentid();            if (flag)                break;        }    }    return false;}function checkElements() {    for (i = 0; i < position_array.length; i++) {        if (parseInt(position_array[i].page) == current_page) {            uid = parseInt(position_array[i].val[0].uid);            nextelement();        }    }}function gotopage() {    var temp = parseInt(document.getElementById("search").value);    if (temp <= 0 | temp > no_of_pages) {        alert("sorry");    }    else {        current_page = temp;        var page3 = document.getElementsByClassName('pages');        for (t = 0; t < page3.length; t++) {            page3[t].style.display = 'none';        }        document.getElementById("page" + current_page).style.display = "block";        checkElements();    }}function clear() {    alert("clear called");}function reset() {    $("#signature").jSignature('reset');}function cancel() {    reset();    resettyped();    document.getElementById("tabs").style.display = "none";}var esignid;function show(id) {    document.getElementById("tabs").style.display = "block";    esignid = id;}var fontsName = ["Edwardian Script ITC", "Brush Script MT", "Freestyle Script", "French Script MT", "Gigi", "Ink Free", "Kunstler Script", "Lucida Handwriting", "Mistral", "Rage Italic", "Script MT Bold", "Segoe Script", "Viner Hand ITC", "Vladimir Script"];function setfonts(trig) {    var selectBox = document.getElementById('rec_mode');    selectBox.innerHTML = "";    for (i = 0; i < fontsName.length; i++) {        var option = document.createElement("option");        var text3 = document.getElementById("typed_sign");        if (trig != 1 && text3.value != "" || null) {            var res = trig.slice(0, 20);            option.text = res;        }        else {            option.text = fontsName[i];        }        option.value = fontsName[i];        option.style.fontFamily = fontsName[i];        selectBox.add(option);    }}function setsize() {    var selectBox2 = document.getElementById('f_size');    for (j = 1; j < 100; j++) {        var option2 = document.createElement("option");        if (j == 20) {            option2.selected = "selected";        }        option2.text = j + "px";        selectBox2.add(option2);    }}function change_font_size(size) {    var text1 = document.getElementById("typed_sign");    text1.style.fontSize = size;}function change_fontstyle(style) {    var sty1 = document.getElementById("typed_sign");    sty1.style.fontFamily = style;}function resettyped() {    document.getElementById("typed_sign").value = "";    setfonts(1);}function submit(type) {    var width1, height1;    var div = document.getElementById(esignid);    div.innerHTML = "";    div.style.padding = "10px";    for (i = 0; i < position_array[current_page - 1].val.length; i++) {        if (position_array[current_page - 1].val[i].id == esignid) {            width1 = parseInt(position_array[current_page - 1].val[i].width);            height1 = parseInt(position_array[current_page - 1].val[i].height);        }    }    if (type == 1) {        var $sigdiv = $("#signature");        var datapair = $sigdiv.jSignature("getData", "svgbase64");        var i = new Image();        i.src = "data:" + datapair[0] + "," + datapair[1];        i.style.width = (width1 - 20) + "px";        i.style.height = (height1 - 20) + "px";        $(i).appendTo($("#" + esignid));        var xmlhttp = new XMLHttpRequest();        var url = "http://localhost:8080/rbid/formoperation/form/savesignature?templatename=BP_59170&key=CgOjF&fieldid=$$fieldid$$";        url = url.replace("$$fieldid$$", esignid);        xmlhttp.open("POST", url, true);        xmlhttp.setRequestHeader("Content-Type", "text/plain");        xmlhttp.onreadystatechange = function () {            if (this.readyState == 4 && this.status == 200) {                var obj = JSON.parse(this.responseText);                if (obj.Status == 'Success') {                    for (var p = 0; p < formsdata.length; p++) {                        if (formsdata[p].id == esignid) {                            formsdata[p].value = obj.FilePath;                            break;                        }                    }                } else {                    alert("-=-=-=Error-=-Save Svg=-=" + obj.StatusDetails);                }            }        };        var temp = datapair[1];        xmlhttp.send(temp);    }    else {        var type1 = document.getElementById("typed_sign");        var size1 = document.getElementById("f_size");        var family1 = document.getElementById("rec_mode");        div.innerHTML = type1.value;        div.style.fontFamily = family1.value;        div.style.fontSize = size1.value;        for (var p = 0; p < formsdata.length; p++) {            if (formsdata[p].id == esignid) {                formsdata[p].value = type1.value + "~" + family1.value + "~" + size1.value;            }        }    }    cancel();    return false;}var view = 0;var formsdata = [];function submit1() {    var xmlhttp = new XMLHttpRequest();    xmlhttp.open("POST", "old", true);    xmlhttp.setRequestHeader("Content-Type", "application/json");    xmlhttp.onreadystatechange = function () {        if (this.readyState == 4 && this.status == 200) {        }    };    var temp = JSON.stringify(formsdata);    xmlhttp.send(temp);}function formvalidation() {    var check_submit = 0;    for (i = 0; i < position_array.length; i++) {        for (j = 0; j < position_array[i].val.length; j++) {            var id1 = position_array[i].val[j].id;            var dd = document.getElementById(id1);            temp = { "page_no": position_array[i].page, "id": id1, "value": "null", "x": position_array[i].val[j].x, "y": position_array[i].val[j].y, "width": position_array[i].val[j].width, "height": position_array[i].val[j].height };            formsdata.push(temp);            if (position_array[i].val[j].disabled == "true") {                dd.style.backgroundColor = "#96989B";                dd.setAttribute("onclick", "");                for (var p = 0; p < formsdata.length; p++) {                    if (formsdata[p].id == id1) {                        formsdata[p].value = "disabled";                    }                }            }            if (position_array[i].val[j].mandatory == "true") {                check_submit = check_submit + 1;            }        }    }    if (check_submit != 0) {        var ff = document.getElementById("submitbtn");        ff.style.backgroundColor = "red";    }}function onvaluechange(type, id2) {    for (var p = 0; p < formsdata.length; p++) {        if (formsdata[p].id == id2) {            if (type == "textbox") {                formsdata[p].value = document.getElementById(id2).value;            }            else if (type == "checkbox") {                if ($("#" + id2).is(":checked")) {                    formsdata[p].value = "true";                }                else {                    formsdata[p].value = "false";                }            }            else if (type == "textarea") {                formsdata[p].value = document.getElementById(id2).value;            }        }    }}</script><link href="http://sudeesh.host22.com/vishnu%20g/esign_Style.css" rel="stylesheet" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"></head><body onload="myfunction();"><label id="printjson"></label><div class="container" ><div style="padding:10px;">Page number&nbsp<input type="number"  min="1" max="14" id="search" /><button onclick="gotopage();">Go</button><button style="margin-left:50px;"  id="prev" onclick="previous();">Previous</button><button   id="next" onclick="next();">Next</button><button style="z-index: 2000;position:relative;float:none;margin-left:100px;margin-right:100px;"  id="submitbtn"/>Start</button><input style="margin:5px;" value="download" type="button" onclick="downloadOutputPdfFile();"/><input style="margin:5px;" id="rejectBtn" value="Reject"  type="button"/><input style="margin:5px;"  value="Finish"  onclick="submit1();" type="button"/></div><div  id="page1"  class="pages" style="background-size:816px 1056px;background-position:top right;background-repeat:no-repeat;width:817px;height:1057px;border:1px solid black;position:absolute;display:block;background-image: url('http://localhost:38391//ESignImageFolder/vishnu@cygnussoftwares.com_CgOjF//BP_59170_Collate_09070/1.jpeg');"><div  onclick="show(this.id);"  class="pdftype" id="signature46168" style="border:1px solid gray;width:285px;height:50px;margin-left:314px;margin-top:883px;">signature</div></div><div  id="page2"  class="pages" style="background-size:816px 1056px;background-position:top right;background-repeat:no-repeat;width:817px;height:1057px;border:1px solid black;position:absolute;display:none;background-image: url('http://localhost:38391//ESignImageFolder/vishnu@cygnussoftwares.com_CgOjF//BP_59170_Collate_09070/2.jpeg');"><input onchange="onvaluechange('textbox','text18450');"  class="pdftype" type="text" id="text18450" style="width:254px;height:50px;margin-left:182px;margin-top:763px;"/></div><div  id="page3"  class="pages" style="background-size:816px 1056px;background-position:top right;background-repeat:no-repeat;width:817px;height:1057px;border:1px solid black;position:absolute;display:none;background-image: url('http://localhost:38391//ESignImageFolder/vishnu@cygnussoftwares.com_CgOjF//BP_59170_Collate_09070/3.jpeg');"></div><div  id="page4"  class="pages" style="background-size:816px 1056px;background-position:top right;background-repeat:no-repeat;width:817px;height:1057px;border:1px solid black;position:absolute;display:none;background-image: url('http://localhost:38391//ESignImageFolder/vishnu@cygnussoftwares.com_CgOjF//BP_59170_Collate_09070/4.jpeg');"></div><div  id="page5"  class="pages" style="background-size:816px 1056px;background-position:top right;background-repeat:no-repeat;width:817px;height:1057px;border:1px solid black;position:absolute;display:none;background-image: url('http://localhost:38391//ESignImageFolder/vishnu@cygnussoftwares.com_CgOjF//BP_59170_Collate_09070/5.jpeg');"></div><div id="page6"  class="pages" style="background-size:1056px 816px;background-position:top right;background-repeat:no-repeat;width:1057px;height:817px;border:1px solid black;position:absolute;display:none; background-image: url('http://localhost:38391//ESignImageFolder/vishnu@cygnussoftwares.com_CgOjF//BP_59170_Collate_09070/6.jpeg');"></div><div  id="page7"  class="pages" style="background-size:816px 1056px;background-position:top right;background-repeat:no-repeat;width:817px;height:1057px;border:1px solid black;position:absolute;display:none;background-image: url('http://localhost:38391//ESignImageFolder/vishnu@cygnussoftwares.com_CgOjF//BP_59170_Collate_09070/7.jpeg');"></div><div  id="page8"  class="pages" style="background-size:816px 1056px;background-position:top right;background-repeat:no-repeat;width:817px;height:1057px;border:1px solid black;position:absolute;display:none;background-image: url('http://localhost:38391//ESignImageFolder/vishnu@cygnussoftwares.com_CgOjF//BP_59170_Collate_09070/8.jpeg');"></div><div  id="page9"  class="pages" style="background-size:816px 1056px;background-position:top right;background-repeat:no-repeat;width:817px;height:1057px;border:1px solid black;position:absolute;display:none;background-image: url('http://localhost:38391//ESignImageFolder/vishnu@cygnussoftwares.com_CgOjF//BP_59170_Collate_09070/9.jpeg');"></div><div  id="page10"  class="pages" style="background-size:816px 1056px;background-position:top right;background-repeat:no-repeat;width:817px;height:1057px;border:1px solid black;position:absolute;display:none;background-image: url('http://localhost:38391//ESignImageFolder/vishnu@cygnussoftwares.com_CgOjF//BP_59170_Collate_09070/10.jpeg');"></div><div  id="page11"  class="pages" style="background-size:816px 1056px;background-position:top right;background-repeat:no-repeat;width:817px;height:1057px;border:1px solid black;position:absolute;display:none;background-image: url('http://localhost:38391//ESignImageFolder/vishnu@cygnussoftwares.com_CgOjF//BP_59170_Collate_09070/11.jpeg');"></div><div  id="page12"  class="pages" style="background-size:816px 1056px;background-position:top right;background-repeat:no-repeat;width:817px;height:1057px;border:1px solid black;position:absolute;display:none;background-image: url('http://localhost:38391//ESignImageFolder/vishnu@cygnussoftwares.com_CgOjF//BP_59170_Collate_09070/12.jpeg');"></div><div  id="page13"  class="pages" style="background-size:816px 1056px;background-position:top right;background-repeat:no-repeat;width:817px;height:1057px;border:1px solid black;position:absolute;display:none;background-image: url('http://localhost:38391//ESignImageFolder/vishnu@cygnussoftwares.com_CgOjF//BP_59170_Collate_09070/13.jpeg');"></div><div  id="page14"  class="pages" style="background-size:816px 1056px;background-position:top right;background-repeat:no-repeat;width:817px;height:1057px;border:1px solid black;position:absolute;display:none;background-image: url('http://localhost:38391//ESignImageFolder/vishnu@cygnussoftwares.com_CgOjF//BP_59170_Collate_09070/14.jpeg');"><div onclick="show(this.id);"  class="pdftype"  id="initial61342" style="width:130px;height:50px;margin-left:265px;margin-top:545px;">initial</div><input onchange="onvaluechange('textbox','text99167');"  class="pdftype" type="text" id="text99167" style="width:148px;height:50px;margin-left:115px;margin-top:544px;"/><input onchange="onvaluechange('textbox','text99288');"  class="pdftype" type="text" id="text99288" style="width:150px;height:50px;margin-left:115px;margin-top:619px;"/><div  onclick="show(this.id);"  class="pdftype" id="signature65943" style="border:1px solid gray;width:370px;height:50px;margin-left:268px;margin-top:624px;">signature</div></div><div style="visibility: hidden;" id="hiddenDiv"><input name="FormId" id="BP_59170" value="FORM15853"><input name="CustomerKey" id="customerkey" value="CgOjF"></div></div><div class="container tabs" id="tabs" style="display:none;z-index:50;position:relative;"><ul class="nav nav-tabs" role="tablist"><li class="active"><a href="#home" role="tab" data-toggle="tab"><i class="fa fa-home"></i> Draw</a></li><li><a href="#profile" role="tab" data-toggle="tab"><i class="fa fa-user"></i> Type</a></li> <a onclick="cancel();" class="cancel1"><i class="fa fa-close" id="closebutton"></i></a></ul><div class="tab-content"><div class="tab-pane fade active in" id="home"><h3>Sign here</h3><div   id="signature"></div><div class="row" id="row1"><button onclick="submit(1);">OK</button><button onclick="reset();">Reset</button><button onclick="cancel();">Cancel</button></div></div><div class="tab-pane fade" id="profile"><h3>Type here</h3><div class="row" id="buttons"><select onchange="change_fontstyle(this.options[this.selectedIndex].value);" id="rec_mode"></select><select value="14px" onchange="change_font_size(this.options[this.selectedIndex].text);" id="f_size"></select></div><input type="text" id="typed_sign"    onchange="setfonts(this.value)"/><div class="row" style="margin-top:20px"><button onclick="submit(2);">OK</button><button onclick="resettyped();">Reset</button><button onclick="cancel();">Cancel</button></div></div></div></div><input type="text" id="currStage" value="1" style="visibility: hidden"/><input type="text" id="currStageUsers" value="john@cygnussoftwares.com" style="visibility: hidden"/></body></html>